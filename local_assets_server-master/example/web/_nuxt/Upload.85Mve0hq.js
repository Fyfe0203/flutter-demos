import{E as w}from"./el-progress.CLXG3XdX.js";import{u as b,G as U,q as A,cv as R,b as i}from"./entry.nbMAVAIE.js";import{d as z,c as n,A as C,F as E,X as I,Y as L,N as S,O as k,u}from"./swiper-vue.o0IHd9hR.js";import"./typescript.WBLZcIum.js";import"./_baseClone.DMOROgmz.js";import"./_initCloneObject.aIezyqVt.js";const q=z({__name:"Upload",props:{limit:{},action:{},accept:{}},emits:["update:url","update:preview","update:loading","update:file"],setup(l,{emit:d}){const m=b().app,o=l,p=n(()=>o.limit??2),r=n(()=>o.accept??""),f=U().public.baseURL+(C(o).action||"/admin/file/upload"),t=d,h=n(()=>({Authorization:m.authorization})),v=(e,s)=>{const{data:a}=e;s.response=a,t("update:file",s),t("update:url",a),t("update:loading",!1)},_=()=>{t("update:preview",""),t("update:loading",!1)},{t:c}=A(),g=e=>{if(R(e.type||e.name.split(".").slice(-1)[0],r.value)){if(e.size/1024/1024>p.value)return i.error(c("rule.t013",[p.value])),!1}else return i.error(c("rule.t012",[r.value])),!1;const a=URL.createObjectURL(e);return t("update:preview",a),t("update:loading",!0),t("update:file",e),!0};return(e,s)=>{const a=w;return E(),I(a,k(e.$attrs,{action:f,"show-file-list":!1,"on-success":v,"on-error":_,"before-upload":g,headers:u(h),accept:u(r)}),{default:L(()=>[S(e.$slots,"default")]),_:3},16,["headers","accept"])}}});export{q as default};

import{aB as V,aC as be,n as ve,y as re,a1 as me,aD as de,d as Q,aE as fe,aF as Ie,aG as _e,ai as pe,q as ge,aH as Le,r as b,aI as ze,aJ as Ce,N as v,U as ie,a8 as we,t as ye,o as y,m as ue,f as c,w as _,e as w,x as d,g as t,ak as ce,ag as Ee,aa as L,B as O,aK as xe,c as N,$ as J,aL as Ne,S as Se,aM as Oe,aN as Te,A as Re,aO as $e,aP as Ae,ac as Be,Y as Ve,Z as Me,v as G,T as Ye,aQ as Xe,_ as he,aq as M,H as B,aR as De,F as ke,aS as Fe,aT as He,C as Pe,J as We,aU as Ke,X as je,aV as Ze,aW as qe}from"./index-cba2b4c0.js";import{d as Ue}from"./index-877b19ec.js";const Ge=(i,f)=>{if(!V||!i||!f)return!1;const l=i.getBoundingClientRect();let s;return f instanceof Element?s=f.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},l.top<s.bottom&&l.bottom>s.top&&l.right>s.left&&l.left<s.right};var Je="Expected a function";function oe(i,f,l){var s=!0,h=!0;if(typeof i!="function")throw new TypeError(Je);return be(l)&&(s="leading"in l?!!l.leading:s,h="trailing"in l?!!l.trailing:h),Ue(i,f,{leading:s,maxWait:f,trailing:h})}const Qe=ve({urlList:{type:re(Array),default:()=>me([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),ea={close:()=>!0,switch:i=>de(i)},aa=["src"],ta=Q({name:"ElImageViewer"}),na=Q({...ta,props:Qe,emits:ea,setup(i,{expose:f,emit:l}){const s=i,h={CONTAIN:{name:"contain",icon:fe(Ie)},ORIGINAL:{name:"original",icon:fe(_e)}},{t:z}=pe(),r=ge("image-viewer"),{nextZIndex:ee}=Le(),T=b(),S=b([]),C=ze(),I=b(!0),m=b(s.initialIndex),p=Ce(h.CONTAIN),u=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),Y=v(()=>{const{urlList:e}=s;return e.length<=1}),$=v(()=>m.value===0),H=v(()=>m.value===s.urlList.length-1),ae=v(()=>s.urlList[m.value]),te=v(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!s.infinite&&$.value)]),X=v(()=>[r.e("btn"),r.e("next"),r.is("disabled",!s.infinite&&H.value)]),ne=v(()=>{const{scale:e,deg:n,offsetX:o,offsetY:g,enableTransition:E}=u.value;let k=o/e,x=g/e;switch(n%360){case 90:case-270:[k,x]=[x,-k];break;case 180:case-180:[k,x]=[-k,-x];break;case 270:case-90:[k,x]=[-x,k];break}const A={transform:`scale(${e}) rotate(${n}deg) translate(${k}px, ${x}px)`,transition:E?"transform .3s":""};return p.value.name===h.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A}),P=v(()=>de(s.zIndex)?s.zIndex:ee());function R(){le(),l("close")}function se(){const e=oe(o=>{switch(o.code){case B.esc:s.closeOnPressEscape&&R();break;case B.space:Z();break;case B.left:q();break;case B.up:a("zoomIn");break;case B.right:U();break;case B.down:a("zoomOut");break}}),n=oe(o=>{const g=o.deltaY||o.deltaX;a(g<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});C.run(()=>{M(document,"keydown",e),M(document,"wheel",n)})}function le(){C.stop()}function W(){I.value=!1}function K(e){I.value=!1,e.target.alt=z("el.image.error")}function j(e){if(I.value||e.button!==0||!T.value)return;u.value.enableTransition=!1;const{offsetX:n,offsetY:o}=u.value,g=e.pageX,E=e.pageY,k=oe(A=>{u.value={...u.value,offsetX:n+A.pageX-g,offsetY:o+A.pageY-E}}),x=M(document,"mousemove",k);M(document,"mouseup",()=>{x()}),e.preventDefault()}function D(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Z(){if(I.value)return;const e=De(h),n=Object.values(h),o=p.value.name,E=(n.findIndex(k=>k.name===o)+1)%e.length;p.value=h[e[E]],D()}function F(e){const n=s.urlList.length;m.value=(e+n)%n}function q(){$.value&&!s.infinite||F(m.value-1)}function U(){H.value&&!s.infinite||F(m.value+1)}function a(e,n={}){if(I.value)return;const{zoomRate:o,rotateDeg:g,enableTransition:E}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(e){case"zoomOut":u.value.scale>.2&&(u.value.scale=Number.parseFloat((u.value.scale/o).toFixed(3)));break;case"zoomIn":u.value.scale<7&&(u.value.scale=Number.parseFloat((u.value.scale*o).toFixed(3)));break;case"clockwise":u.value.deg+=g;break;case"anticlockwise":u.value.deg-=g;break}u.value.enableTransition=E}return ie(ae,()=>{we(()=>{const e=S.value[0];e!=null&&e.complete||(I.value=!0)})}),ie(m,e=>{D(),l("switch",e)}),ye(()=>{var e,n;se(),(n=(e=T.value)==null?void 0:e.focus)==null||n.call(e)}),f({setActiveItem:F}),(e,n)=>(y(),ue(Xe,{to:"body",disabled:!e.teleported},[c(Ye,{name:"viewer-fade",appear:""},{default:_(()=>[w("div",{ref_key:"wrapper",ref:T,tabindex:-1,class:d(t(r).e("wrapper")),style:ce({zIndex:t(P)})},[w("div",{class:d(t(r).e("mask")),onClick:n[0]||(n[0]=Ee(o=>e.hideOnClickModal&&R(),["self"]))},null,2),L(" CLOSE "),w("span",{class:d([t(r).e("btn"),t(r).e("close")]),onClick:R},[c(t(O),null,{default:_(()=>[c(t(xe))]),_:1})],2),L(" ARROW "),t(Y)?L("v-if",!0):(y(),N(J,{key:0},[w("span",{class:d(t(te)),onClick:q},[c(t(O),null,{default:_(()=>[c(t(Ne))]),_:1})],2),w("span",{class:d(t(X)),onClick:U},[c(t(O),null,{default:_(()=>[c(t(Se))]),_:1})],2)],64)),L(" ACTIONS "),w("div",{class:d([t(r).e("btn"),t(r).e("actions")])},[w("div",{class:d(t(r).e("actions__inner"))},[c(t(O),{onClick:n[1]||(n[1]=o=>a("zoomOut"))},{default:_(()=>[c(t(Oe))]),_:1}),c(t(O),{onClick:n[2]||(n[2]=o=>a("zoomIn"))},{default:_(()=>[c(t(Te))]),_:1}),w("i",{class:d(t(r).e("actions__divider"))},null,2),c(t(O),{onClick:Z},{default:_(()=>[(y(),ue(Re(t(p).icon)))]),_:1}),w("i",{class:d(t(r).e("actions__divider"))},null,2),c(t(O),{onClick:n[3]||(n[3]=o=>a("anticlockwise"))},{default:_(()=>[c(t($e))]),_:1}),c(t(O),{onClick:n[4]||(n[4]=o=>a("clockwise"))},{default:_(()=>[c(t(Ae))]),_:1})],2)],2),L(" CANVAS "),w("div",{class:d(t(r).e("canvas"))},[(y(!0),N(J,null,Be(e.urlList,(o,g)=>Ve((y(),N("img",{ref_for:!0,ref:E=>S.value[g]=E,key:o,src:o,style:ce(t(ne)),class:d(t(r).e("img")),onLoad:W,onError:K,onMousedown:j},null,46,aa)),[[Me,g===m.value]])),128))],2),G(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var sa=he(na,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const la=ke(sa),oa=ve({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:re([String,Object])},previewSrcList:{type:re(Array),default:()=>me([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),ra={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>de(i),close:()=>!0,show:()=>!0},ia=["src","loading"],ua={key:0},ca=Q({name:"ElImage",inheritAttrs:!1}),da=Q({...ca,props:oa,emits:ra,setup(i,{emit:f}){const l=i;let s="";const{t:h}=pe(),z=ge("image"),r=Fe(),ee=He(),T=b(),S=b(!1),C=b(!0),I=b(!1),m=b(),p=b(),u=V&&"loading"in HTMLImageElement.prototype;let Y,$;const H=v(()=>[z.e("inner"),X.value&&z.e("preview"),C.value&&z.is("loading")]),ae=v(()=>r.style),te=v(()=>{const{fit:a}=l;return V&&a?{objectFit:a}:{}}),X=v(()=>{const{previewSrcList:a}=l;return Array.isArray(a)&&a.length>0}),ne=v(()=>{const{previewSrcList:a,initialIndex:e}=l;let n=e;return e>a.length-1&&(n=0),n}),P=v(()=>l.loading==="eager"?!1:!u&&l.loading==="lazy"||l.lazy),R=()=>{V&&(C.value=!0,S.value=!1,T.value=l.src)};function se(a){C.value=!1,S.value=!1,f("load",a)}function le(a){C.value=!1,S.value=!0,f("error",a)}function W(){Ge(m.value,p.value)&&(R(),D())}const K=qe(W,200,!0);async function j(){var a;if(!V)return;await we();const{scrollContainer:e}=l;Ke(e)?p.value=e:je(e)&&e!==""?p.value=(a=document.querySelector(e))!=null?a:void 0:m.value&&(p.value=Ze(m.value)),p.value&&(Y=M(p,"scroll",K),setTimeout(()=>W(),100))}function D(){!V||!p.value||!K||(Y==null||Y(),p.value=void 0)}function Z(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function F(){X.value&&($=M("wheel",Z,{passive:!1}),s=document.body.style.overflow,document.body.style.overflow="hidden",I.value=!0,f("show"))}function q(){$==null||$(),document.body.style.overflow=s,I.value=!1,f("close")}function U(a){f("switch",a)}return ie(()=>l.src,()=>{P.value?(C.value=!0,S.value=!1,D(),j()):R()}),ye(()=>{P.value?j():R()}),(a,e)=>(y(),N("div",{ref_key:"container",ref:m,class:d([t(z).b(),a.$attrs.class]),style:ce(t(ae))},[S.value?G(a.$slots,"error",{key:0},()=>[w("div",{class:d(t(z).e("error"))},Pe(t(h)("el.image.error")),3)]):(y(),N(J,{key:1},[T.value!==void 0?(y(),N("img",We({key:0},t(ee),{src:T.value,loading:a.loading,style:t(te),class:t(H),onClick:F,onLoad:se,onError:le}),null,16,ia)):L("v-if",!0),C.value?(y(),N("div",{key:1,class:d(t(z).e("wrapper"))},[G(a.$slots,"placeholder",{},()=>[w("div",{class:d(t(z).e("placeholder"))},null,2)])],2)):L("v-if",!0)],64)),t(X)?(y(),N(J,{key:2},[I.value?(y(),ue(t(la),{key:0,"z-index":a.zIndex,"initial-index":t(ne),infinite:a.infinite,"zoom-rate":a.zoomRate,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:q,onSwitch:U},{default:_(()=>[a.$slots.viewer?(y(),N("div",ua,[G(a.$slots,"viewer")])):L("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):L("v-if",!0)],64)):L("v-if",!0)],6))}});var fa=he(da,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const pa=ke(fa);export{pa as E};

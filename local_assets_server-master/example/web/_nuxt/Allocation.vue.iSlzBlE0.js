import{E as H,a as K}from"./el-radio-group.3uGDqfeP.js";import{_ as L}from"./InputNum.vue.Is6puA7Y.js";import{$ as M,u as W,aY as X,d as Z}from"./entry.iYjkhHK1.js";import J from"./Button.0ywGpm4G.js";import{_ as O}from"./AddCoins.vue.cbXebdJv.js";import{u as m}from"./useFormat.c8XsG793.js";import{d as Q,a as g,c as R,E as ee,w,an as S,F as n,G as c,H as _,a2 as i,u as l,X as j,Y as C,a6 as y,W as f,k as te,Z as b,R as z,T as oe,al as ae,P as le,a0 as ne}from"./swiper-vue.o0IHd9hR.js";const se={class:"w-full"},ie={class:"flex-center-x gap-x-3 mb-2 flex-wrap"},ue={class:"flex-1 text-base font-medium"},ce={class:"flex flex-col gap-[10px]"},re={class:"flex-1 flex-center-x gap-[10px] bg-[#F3F3F3] rounded-[10px] pr-2 pl-4 py-[11px]"},de={class:"text-sm"},pe=["data-key"],me={class:"flex-1 text-base font-medium"},_e=["onClick"],fe={key:0,class:"text-sm font-medium"},ve={key:1},he={key:0},A=10,Ve=Q({__name:"Allocation",props:{modelValue:{default:()=>[]},chainType:{},allocationType:{default:2},teleport:{default:"body"}},emits:["update:modelValue","update:chainType","update:allocationType"],setup(D,{emit:I}){const k=I,x=D,r=g(2),o=g([]),d=g(""),E=R(()=>o.value.reduce((e,t)=>m.plus(e,t.ratio),0)),U=R(()=>o.value.map(e=>[e.coinCode,e.ratio].join(",")).join(";")),F=g(!1),B=e=>{var s;F.value=!!e;const t=(s=document.querySelector(x.teleport))==null?void 0:s.querySelector(".manual-form");t&&(t.style.display=F.value?"none":"block")},V=(e=o.value,t=d.value)=>{let s="0",u="0",v="0";r.value===2?u=m.div(100,e.length).toFixed(2):(v=e.reduce((p,h)=>m.plus(h.marketValue,p).toFixed(2),0),+v==0&&(u=m.div(100,e.length).toFixed(2))),o.value=e.map((p,h)=>(r.value!==2&&+v>0&&(u=m.div(p.marketValue,v).mul(100).toFixed(2,0)),h<e.length-1?s=m.plus(s,u).toFixed(2):u=m.minus(100,s).toFixed(2),{...p,ratio:u})),d.value=t},q=(e,t)=>{o.value.splice(t,1),V(o.value)};ee(()=>{o.value=[...x.modelValue],d.value=x.chainType,r.value=x.allocationType});const{formItem:T}=M();return w(U,()=>{k("update:modelValue",o.value),k("update:allocationType",r.value),T==null||T.validate("change").catch(e=>{})}),w(d,()=>{k("update:chainType",d.value||"")}),w(()=>{var e;return(e=W().app.chains[0])==null?void 0:e.chainType},e=>{d.value=e??""},{immediate:!0}),(e,t)=>{const s=H,u=K,v=L,p=Z,h=J,G=O,P=S("lazy"),Y=S("auto-animate");return n(),c("div",se,[_("div",ie,[_("div",ue,i(e.$t("bot.t25")),1),l(o).length?(n(),j(u,{key:0,modelValue:l(r),"onUpdate:modelValue":t[0]||(t[0]=a=>te(r)?r.value=a:null),class:"gap-x-2 cus-radio flex-nowrap",onChange:t[1]||(t[1]=a=>V())},{default:C(()=>[f(s,{label:2},{default:C(()=>[y(i(e.$t("bot.t926")),1)]),_:1}),f(s,{label:1},{default:C(()=>[y(i(e.$t("bot.t927")),1)]),_:1})]),_:1},8,["modelValue"])):b("",!0)]),z((n(),c("dl",ce,[(n(!0),c(oe,null,ae(l(o),(a,$)=>(n(),c("dd",{key:$,class:"flex-center-x gap-2"},[_("div",re,[_("div",de,i($+1),1),z((n(),c("img",{key:a.coinCode,"data-key":a.coinCode,class:"h-6 w-6 rounded-full object-cover",alt:""},null,8,pe)),[[P,("findCoinImg"in e?e.findCoinImg:l(X))(a)]]),_("div",me,i(a.coinCode),1),f(v,{modelValue:a.ratio,"onUpdate:modelValue":N=>a.ratio=N,min:0,max:100,precision:2,unit:"%",class:"!w-[110px] !h-6"},null,8,["modelValue","onUpdate:modelValue"])]),_("button",{type:"button",class:"h-9 w-9 flex-center hover:bg-[#F3F3F3] rounded-[10px]",onClick:N=>q(a,$)},[f(p,{name:"delete"})],8,_e)]))),128)),l(o).length?(n(),c("dd",fe,[y(i(e.$t("bot.t928"))+" ",1),_("span",{class:le(l(E)>100?"text-red-500":"text-gray2")},i(l(E))+"%",3),y(" / "+i(e.$t("bot.t929"))+" 100% ",1)])):b("",!0),l(o).length<A?(n(),c("dt",ve,[f(h,{plain:"",class:"!h-[46px]",onClick:t[2]||(t[2]=a=>B(1))},{default:C(()=>[f(p,{name:"create/add",class:"mr-2"}),y(" "+i(e.$t("bot.t920")),1)]),_:1})])):b("",!0)])),[[Y]]),l(F)?(n(),c("div",he,[(n(),j(ne,{to:e.teleport},[f(G,{limit:A,list:l(o),"chain-type":l(d),onBack:t[3]||(t[3]=a=>B(0)),onFinish:V},null,8,["list","chain-type"])],8,["to"]))])):b("",!0)])}}});export{Ve as _};

import{d as T,r as i,a as z,t as A,a8 as H,o as n,m as f,w as s,e as g,f as t,g as e,c as x,$ as N,ac as R,aa as q,i as U,j as _,E as D,k as G}from"./index-cba2b4c0.js";import{E as J,a as K}from"./el-form-item-a7ed5b06.js";/* empty css                  */import{E as Q}from"./el-switch-5c031674.js";import{_ as W}from"./Password.vue_vue_type_script_setup_true_lang-4de7b790.js";/* empty css                 */import"./el-tag-3e82924f.js";import{E as X,a as Y}from"./el-select-7e09c5da.js";import"./el-popper-b7327fbb.js";import{u as r}from"./useRule-31f8c705.js";import{u as Z}from"./useMd5-a28aa71e.js";const h={class:"grid grid-cols-2 gap-x-6"},ee={class:"flex justify-center mt-6"},ie=T({__name:"AddEditModal",props:{row:{type:Object,default:()=>{}}},emits:["close"],setup(C,{emit:B}){const v=C,V=i(),l=i({status:1}),c=r.empty(),I=[r.empty(),r.phone()],$=r.email(),F=[r.empty(),r.password()],j=z({0:"女",1:"男"}),b=i([]),M=async()=>{const{content:m}=await _.get("/sys/role/list");b.value=m};A(()=>{M(),H(()=>{v.row.id&&(l.value={...v.row})})});const d=i(!1),P=()=>{V.value.validate(async m=>{if(m)try{d.value=!0,l.value.id?await _.put(`/sys/user/${l.value.id}`,l.value):await _.post("/sys/user",{...l.value,password:Z(l.value.password||"")}),d.value=!1,B("close",!0)}catch{d.value=!1}})};return(m,a)=>{const p=D,u=J,w=X,y=Y,L=W,O=Q,E=G,S=K;return n(),f(S,{ref_key:"formRef",ref:V,model:e(l),size:"large","label-position":"top"},{default:s(()=>[g("div",h,[t(u,{label:"用户昵称",prop:"nickName",rules:e(c)},{default:s(()=>[t(p,{modelValue:e(l).nickName,"onUpdate:modelValue":a[0]||(a[0]=o=>e(l).nickName=o)},null,8,["modelValue"])]),_:1},8,["rules"]),t(u,{label:"角色",prop:"roleIds",rules:e(c)},{default:s(()=>[t(y,{modelValue:e(l).roleIds,"onUpdate:modelValue":a[1]||(a[1]=o=>e(l).roleIds=o),multiple:"",class:"w-full"},{default:s(()=>[(n(!0),x(N,null,R(e(b),o=>(n(),f(w,{key:o.id,disabled:!o.status,label:o.name,value:o.id},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),t(u,{label:"手机号码",prop:"phone",rules:I},{default:s(()=>[t(p,{modelValue:e(l).phone,"onUpdate:modelValue":a[2]||(a[2]=o=>e(l).phone=o)},null,8,["modelValue"])]),_:1}),t(u,{label:"邮箱",prop:"email",rules:e($)},{default:s(()=>[t(p,{modelValue:e(l).email,"onUpdate:modelValue":a[3]||(a[3]=o=>e(l).email=o)},null,8,["modelValue"])]),_:1},8,["rules"]),t(u,{label:"用户名称",prop:"username",rules:e(c)},{default:s(()=>[t(p,{modelValue:e(l).username,"onUpdate:modelValue":a[4]||(a[4]=o=>e(l).username=o)},null,8,["modelValue"])]),_:1},8,["rules"]),e(l).id?q("",!0):(n(),f(u,{key:0,label:"密码",prop:"password",rules:F},{default:s(()=>[t(L,{"model-value":e(l).password,"onUpdate:modelValue":a[5]||(a[5]=o=>e(l).password=o)},null,8,["model-value"])]),_:1})),t(u,{label:"用户性别",prop:"sex"},{default:s(()=>[t(y,{modelValue:e(l).sex,"onUpdate:modelValue":a[6]||(a[6]=o=>e(l).sex=o),class:"w-full"},{default:s(()=>[(n(!0),x(N,null,R(e(j),(o,k)=>(n(),f(w,{key:k,label:o,value:Number(k)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"状态",prop:"status"},{default:s(()=>[t(O,{modelValue:e(l).status,"onUpdate:modelValue":a[7]||(a[7]=o=>e(l).status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),g("div",ee,[t(E,{type:"info",disabled:e(d),onClick:a[8]||(a[8]=o=>m.$emit("close"))},{default:s(()=>[U("关闭")]),_:1},8,["disabled"]),t(E,{type:"primary",loading:e(d),onClick:P},{default:s(()=>[U("保存")]),_:1},8,["loading"])])]),_:1},8,["model"])}}});export{ie as _};

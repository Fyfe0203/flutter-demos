import{d as R,r as b,a2 as S,o as n,m,w as d,g as e,c as $,f as s,aa as w,e as j,i as c,C as v,j as C,E as I,k as M}from"./index-0207282d.js";import{E as D,a as H}from"./el-form-item-cffcfafd.js";/* empty css                  */import{_ as O}from"./BtnCode.vue_vue_type_style_index_0_lang-36bef829.js";/* empty css                 */import{u as p}from"./useRule-31f8c705.js";import{u as T}from"./useMd5-a28aa71e.js";import{E as q}from"./message-4c47188d.js";const z={key:0},A={key:1},G={class:"flex-center-x gap-4 w-full"},x=R({__name:"SetTradePassword",props:{info:{type:Object,default:()=>{}}},emits:["close"],setup(g,{emit:P}){const _=g,E={oldPwd:p.empty(),newTradePwd:[p.empty(),p.password()],confirmPassword:p.passwordConfirm(()=>t.value.newTradePwd),code:p.empty(),email:p.email()},V=b(),t=b({email:""}),r=b(1);S(()=>{t.value.email=_.info.email});const B=()=>C.post("/send/email/code",{type:0,email:t.value.email}),u=b(!1),k=o=>{o==null||o.validate(async l=>{if(l){if(r.value===1){r.value=2;return}u.value=!0;try{await C.putForm("/info/set/trade-passwd",{tradePwd:T(t.value.tradePwd),newTradePwd:T(t.value.newTradePwd),code:t.value.code}),q.success("设置成功"),P("close",!0)}finally{u.value=!1}}})},U=_.info.tradePwdStatus;return(o,l)=>{const f=I,i=D,F=O,y=M,N=H;return n(),m(N,{ref_key:"formRef",ref:V,model:e(t),rules:E,"label-position":"top"},{default:d(()=>[e(r)===1?(n(),$("div",z,[e(U)?(n(),m(i,{key:0,label:o.$t("user.t14"),prop:"oldPwd"},{default:d(()=>[s(f,{modelValue:e(t).oldPwd,"onUpdate:modelValue":l[0]||(l[0]=a=>e(t).oldPwd=a),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):w("",!0),s(i,{label:o.$t("user.t15"),prop:"newTradePwd"},{default:d(()=>[s(f,{modelValue:e(t).newTradePwd,"onUpdate:modelValue":l[1]||(l[1]=a=>e(t).newTradePwd=a),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),s(i,{label:o.$t("user.t16"),prop:"confirmPassword"},{default:d(()=>[s(f,{modelValue:e(t).confirmPassword,"onUpdate:modelValue":l[2]||(l[2]=a=>e(t).confirmPassword=a),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])])):(n(),$("div",A,[s(i,{label:o.$t("public.mail"),prop:"email"},{default:d(()=>[s(f,{modelValue:e(t).email,"onUpdate:modelValue":l[3]||(l[3]=a=>e(t).email=a),type:"text",disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),s(i,{label:o.$t("public.verify_code"),prop:"code"},{default:d(()=>[j("div",G,[s(f,{modelValue:e(t).code,"onUpdate:modelValue":l[4]||(l[4]=a=>e(t).code=a),type:"text"},null,8,["modelValue"]),s(F,{fun:B})])]),_:1},8,["label"])])),s(i,{class:"pt-5"},{default:d(()=>[e(r)===1?(n(),m(y,{key:0,type:"default",disabled:e(u),onClick:l[5]||(l[5]=a=>P("close"))},{default:d(()=>[c(v(o.$t("public.t3")),1)]),_:1},8,["disabled"])):w("",!0),e(r)===2?(n(),m(y,{key:1,type:"default",disabled:e(u),onClick:l[6]||(l[6]=a=>r.value=1)},{default:d(()=>[c(v(o.$t("user.btn1")),1)]),_:1},8,["disabled"])):w("",!0),e(r)===1?(n(),m(y,{key:2,type:"primary",disabled:e(u),onClick:l[7]||(l[7]=a=>k(e(V)))},{default:d(()=>[c(v(o.$t("user.btn2")),1)]),_:1},8,["disabled"])):w("",!0),e(r)===2?(n(),m(y,{key:3,type:"primary",loading:e(u),onClick:l[8]||(l[8]=a=>k(e(V)))},{default:d(()=>[c(v(o.$t("public.t2")),1)]),_:1},8,["loading"])):w("",!0)]),_:1})]),_:1},8,["model"])}}});export{x as _};
